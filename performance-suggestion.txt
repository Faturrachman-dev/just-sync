Inefficient O(N*M) Substring Filtering

Start


Description
Uses nested iteration with `indexOf` to filter files, which can be inefficient for large datasets.

Location
src/features/HiddenFileSync/CmdHiddenFileSync.ts:427

Rationale
High confidence. Although logic might require substring check, pre-processing or using optimization structures is possible if the dataset is large.

Code context
    async adoptCurrentDatabaseFilesAsProcessed(targetFiles: FilePath[] | false) {
        const allFiles = await this.getAllDatabaseFiles();
        const files = targetFiles
            ? allFiles.filter((e) => targetFiles.some((t) => e.path.indexOf(t) !== -1))
            : allFiles;

Inefficient O(N*M) Filtering in `rebuildMerging`

Start


Description
Uses nested iteration `filter` + `some` to intersect arrays instead of using a Set for O(N) complexity.

Location
src/features/HiddenFileSync/CmdHiddenFileSync.ts:1032

Rationale
High confidence. Creating a Set from `targetFiles` allows O(1) lookup, reducing overall complexity to O(N).

Code context

N+1 IO in `ConfigSync.storeCustomizationFiles`

Start


Description
Iterates over target files and performs `stat` and `read` operations sequentially.

Location
src/features/ConfigSync/CmdConfigSync.ts:830

Rationale
High confidence. Reading files sequentially is inefficient. Promise.all can speed this up.

Code context

N+1 IO in `ConfigSync.applyData`

Start


Description
Iterates over configuration files and writes them sequentially using `writeHiddenFileAuto`.

Location
src/features/ConfigSync/CmdConfigSync.ts:661

Rationale
High confidence. Writing multiple files sequentially is slower than concurrent writes (within limits).

Code context

N+1 IO in `adoptCurrentStorageFilesAsProcessed`

Start


Description
Loops through files and calls `updateLastProcessedAsActualFile`, which performs a filesystem `stat` call sequentially.

Location
src/features/HiddenFileSync/CmdHiddenFileSync.ts:419

Rationale
High confidence. Sequential IO operations in a loop are a classic performance bottleneck. Can be parallelized.

Code context

Sequential IO in `scanInternalFiles`

Start


Description
Loops through files and awaits `isIgnoredByIgnoreFile` sequentially, delaying the process.

Location
src/features/HiddenFileSync/CmdHiddenFileSync.ts:1150

Rationale
High confidence. The `isIgnoredByIgnoreFile` check is async and done sequentially. Can be parallelized using Promise.all.

Code context
 